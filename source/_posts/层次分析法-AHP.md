---
title: AHP
date: 2024-01-28 18:46:19
tags:
- MCM
- AHP
categories:
- MCM
index_img: /Pictures/MCM/AHP/01.jpg
banner_img: /Pictures/MCM/AHP/01.jpg
---

# 层次分析法(AHP)基本模型

层次分析法旨在对于复杂的决策问题的本质、影响因素及其内在关系等进行深入分析的基础上，利用较少的定量信息使决策的思维过程数学化，从而为多目标、多准则或无结构特性的复杂决策问题提供简便的决策方法。


## 层次分析法概述
AHP的基本内容：
- 将定量分析和定性分析结合起来
- 用决策者的**经验判断**各衡量目标能否实现的标准之间的**相对重要程度**
- 给出每个决策方案的每个标准的权数，利用权数求出各方案的优劣次序

## 层次分析法的典型应用
- 用于最佳方案的选取
- 用于评价类问题
- 用于指标体系的优选

## 层次分析法的步骤和方法

### 建立层次结构模型

>将决策的目标、考虑的因素（决策准则）和决策对象按他们之间的相互关系分为最高层、中间层和最底层，绘出层次结构图。

- 最高层：决策的目的、要解决的问题
- 最底层：决策时的备选方案
- 中间层：考虑的因素、决策的准则

>对于相邻的两层，称高层为目标层，低层为因素层。

例子：对于大学毕业生，在选择就业岗位时，一般会考虑以下因素（不完全）：
1. 能发挥自己的才干做出贡献
2. 收入较好
3. 生活环境好
4. 单位名声好
5. 工作环境好
6. 发展前景好

根据这些因素，我们可以建立以下的层次结构模型：

![img](/Pictures/MCM/AHP/plot01.png)

每层之间的若干元素用直线连接。


### 构造判断（成对比较）矩阵

在确定各层次各因素之间的权重时，如果只是定性的结果，则常常不容易被别人接受。故我们采用**一致矩阵法**，将因素之间两两比较，采用相对尺度，提高准确度。

判断矩阵时表示本层所有因素针对上一层某一个因素的相对重要性的比较。

判断矩阵的元素 $a_{ij}$ （第i项因素相对于第j项元素的标度）由Santy的1-9标度方法给出。

>在选取比较的因素时，建议不要超过9个。

判断矩阵元素 $a_{ij}$ 的标度方法

| 标度 |    含义     |
|:---:|:-----------:|
|  1  |表示两个因素相比,具有同等重要性|
|  3  |表示两个因素相比，一个因素比另一个稍微重要|
|  5  |一个因素比另一个明显重要|
|  7  |一个因素比另一个强烈重要|
|  9  |一个因素比另一个极端重要|
|2,4,6,8|相邻的中值|
|倒数|因素 $i,j$ 之间一方标度为 $a_{ij}$ ,则另一方为倒数|

构造出来的矩阵 $A=(a_{ij})_{n*n}$ 为正互反矩阵

下面是一个例子：

$$\begin{bmatrix}
  1&  \frac{1}{2}&  4&  3&3 \\\\
  2&  1&  7&  5&5 \\\\
  \frac{1}{4}&  \frac{1}{7}&  1&  \frac{1}{2}&\frac{1}{3} \\\\
  \frac{1}{3}&  \frac{1}{5}&  2&  1&1 \\\\
  \frac{1}{3}&  \frac{1}{5}&  3&  1&1
\end{bmatrix}$$


### 层次单排序及其一致性检验

实际上，上述矩阵存在问题。

我们假设因素用 $C_{i}\ (i=1,2,3,4,5)$ 来表示，则 $a_{ij}=C_{i}:C_{j}$

我们发现: $\frac{C_{1}}{C_{2}}=\frac{1}{2}$ , $\frac{C_{1}}{C_{3}}=4$ ,然而 $\frac{C_{2}}{C_{3}}=7$ ，这显然和我们的评价不一致。

考虑到实际情况中存在的**边际效应**和**评价的相对性**，我们允许不一致的出现，但要确定不一致的允许范围。

如果我们得出的矩阵完全一致，即 $rank(A)=1$ ，我们称这样的矩阵为一致阵，其中非零特征值为 $tr(A)=n$ 。

对于不一致的比较矩阵，我们可以将对大的特征值 $\lambda_{max}$ 对应的特征向量作为权向量，记为 $w$ 。

权向量为同一层次因素对于上一层次因素某因素相对重要性的排序权值，这一过程称为层次单排序。

一致性检验的工作正是确定偏移值A的范围。

定义一致性指标如下： 

$$CI\ =\ \frac{\lambda -n}{n-1}$$

**CI越接近于0，一致性越高。**

为衡量CI的大小，引入*随机一致性指标RI*。方法为随即构造500个成对比较矩阵 $A_{n}$ ，可得一致性指标 $CT_{n}$ 。取算术平均数即为RI大小。

对于不同的n，RI的值由下表给出：

| n | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 |
|---|---|---|---|---|---|---|---|---|---|----|----|
| RI| 0 | 0 |0.58|0.90|1.12|1.24|1.32|1.41|1.45|1.49|1.51|

定义一致性比率：

$CR\ =\ \frac{CI}{RI}$ ，当CR<0.1时，认为A的不一致程度在容许范围之内，有满意的一致性，通过一致性检验。可用其归一化 *（列和为1）* 特征向量作为权向量，否则需要重新构造比较矩阵A进行调整。

![img](/Pictures/MCM/AHP/plot02.png)


### 层次总排序及其一致性检验

计算某一层次所有因素对于最高层（总目标）相对重要性的权值，称为层次总排序，这一过程是从最高层次到最低层次依次进行的。

![img](/Pictures/MCM/AHP/plot03.png)

![img](/Pictures/MCM/AHP/plot04.png)

层次总排序的一致性比率为：

$$CR\ =\ \frac{a_{1}CI_{1}+a_{2}CI_{2}+\ldots+a_{m}CI_{m}}{a_{1}RI_{1}+a_{2}RI_{2}+\ldots+a_{m}RI_{m}}$$

当CR<0.1是，认为层次总排序通过一致性检验。层次总排序具有满意度一致性，根据最下层（决策层）的层次总排序做出最后决策。

