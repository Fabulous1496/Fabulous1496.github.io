---
title: TOPSIS
date: 2024-01-28 21:47:08
tags:
- MCM
- TOPSIS
categories:
- MCM
index_img: /Pictures/MCM/TOPSIS/01.jpg
banner_img: /Pictures/MCM/TOPSIS/01.jpg
---

# TOPSIS法简述

TOPSIS法，又称理想解法。这种方法通过构造评价问题的正理想解和负理想解，即各指标的最优解和最劣解，通过计算每个方案到理想方案的相对贴进度，远离最劣解的程度来进行排序。

## 方法和原理

设多属性决策方案集为 $D=$ { $d_{i}|i=1,2,\ldots,n$ } ，衡量方案优劣的属性变量为 $x_{i}$ ，这时方案集D中每个方案的n个属性值构成的向量是 $\left[ a_{i1},\ldots,a_{in} \right]$ ，它作为空间中的一个点，能唯一地表征方案 $d_{i}$ 。

正理想解 $C^{*}$ 是一个方案集中并不存在的虚拟的最佳方案，它的每个属性值都是决策矩阵中该属性的最好值。

而负理想解 $C^{0}$ 是虚拟的最差方案，它的每个属性值都是决策矩阵中该属性的最差值。

在方案集中，尽可能靠近正理想解而原理负理想解的方案就是最佳方案。

在实际操作中我们需要解决如下几个问题：

1. 数据的规律
2. 距离的计算方法和衡量方法
3. 消除量纲的影响

## 算法的步骤

### 用向量规划化的方法求得规范决策矩阵

设多属性决策问题的决策矩阵 $A=(a_{ij})_{m*n}$

规范化决策矩阵 $B=(b_{ij})_{m*n}$ 

其中 $b_{ij}= \frac{a_{ij}}{\sqrt {\sum_{i=1}^{m} a_{ij}^{2}}}$  
>这一步用来消除量纲的影响

对于每一项属性，其所占的评价权重也不尽相同，因此我们需要构造加权规范矩阵 $C=(c_{ij})_{m*n}$

设由决策人给定各属性的权重向量为 $w=[w_{1},w_{2},\ldots,w_{n}]^{T}$ ，则

$$
c_{ij}=w_{j}*b_{ij}
$$


### 确定正理想解和负理想解

设正（负）理想解的第j个属性值为 $c_{j}^{*}$ ( $c_{j}^{0}$ ) ，则：

$$
c_{j}^{\ast}=
\begin{cases}
max\ c_{ij} , j 为效益性属性 \\\\
 \\\\
min\ c_{ij} , j 为成本性属性 \\\\
\end{cases}
$$

$$
c_{j}^{0}=
\begin{cases}
max\ c_{ij} , j 为成本性属性 \\\\
 \\\\
min\ c_{ij} , j 为效益性属性 \\\\
\end{cases}
$$


### 确定距离公式

各方案到正（负）理想解的距离为：


$$
s_{i}^{\ast}\ = \ \sqrt{ \sum_{j=1}^{n} (c_{ij}-c_{j}^{\ast})^{2}}
$$


$$
s_{i}^{0}\ = \ \sqrt{ \sum_{j=1}^{n} (c_{ij}-c_{j}^{0})^{2}}
$$


### 计算综合评价指数


$$
f_{i}^{\ast} \ =\ \frac{s_{i}^{0}} {s_{i}^{0}+s_{i}^{\ast}}
$$


根据综合评价指数便可得出方案的优劣次序。


## 数据的处理

### 属性值比例化
属性值不好直接从数值大小进行判断时，我们需要对数据进行预处理，使得表中任意属性下性能越优的方案变换后的属性值越大。

### 非量纲化
不同属性之间量纲的不同使属性具有不可公度性，我们需要在数据处理时消除量纲的影响。

### 归一化
属性之间数值大小差别较大，为了方便直观比较，我们需要对属性的数值进行归一化。

### 常见的处理方法

1. 线性变换

$$
b_{ij}=\frac{a_{ij}}{a_{j}^{max}}
$$

2. 标准0-1变换

>为了使最优为1，最差为0

对效益性属性：
$$
b_{ij}\=\ \frac{a_{ij}-a_{j}^{max}}{a_{j}^{max}-a_{j}^{min}}
$$

对成本性属性：
$$
b_{ij}\=\ \frac{a_{j}^{max}-a_{ij}}{a_{j}^{max}-a_{j}^{min}}
$$

3. 区间属性的变换
属性在某一个区间范围内最优，我们设给出的最优区间为 $[a_{j}^{0},a_{j}^{\ast}]$ , $a_{j}^{'}$ 为无法容忍下限， $a_{j}^{''}$ 为无法容忍上限，则

$$
b_{ij}=
\begin{cases}
1-\frac{a_{j}^{0}-a_{ij}}{a_{j}^{0}-a_{j}^{'}} , a_{j}^{'}\le a_{ij}\le a_{j}^{0}\\\\
 \\\\
1 , a_{j}^{0}\le a_{ij}\le a_{j}^{\ast}\\\\
 \\\\
1-\frac{a_{ij}-a_{j}^{\ast}}{a_{j}^{''}-a_{j}^{\ast}} , a_{j}^{\ast}\le a_{ij}\le a_{j}^{''}
 \\\\
0
\end{cases}
$$

变换后的属性值对应的函数图形为一般梯形。当最优区间的上下界相等，退化为三角形。

4. 向量规范化

$$
b_{ij}= \frac{a_{ij}}{\sqrt {\sum_{i=1}^{m} a_{ij}^{2}}}
$$

经常用于计算欧氏距离的场合。